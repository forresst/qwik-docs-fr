---
title: Qwik City - Middleware de Cloudflare Pages
contributors:
  - adamdbradley
---

# Middleware de Cloudflare Pages

Vous devez intégrer cloudflare-pages en utilisant cette commande pour voir vos fichiers comme les fichiers ci-dessous

```bash
npm run qwik add cloudflare-pages
```

Le middleware Qwik City de Cloudflare Pages vous permet de connecter Qwik City à [Cloudflare Pages](https://pages.cloudflare.com/).

Vous trouverez ci-dessous un exemple d'utilisation du middleware intégré dans l'appli d'un utilisateur.

```typescript
// entry.cloudflare-pages.tsx
import render from './entry.ssr';
import { qwikCity } from '@builder.io/qwik-city/middleware/cloudflare-pages';

export const onRequest = qwikCity(render);
```

Le middleware compilé peut alors être utilisé n'importe où dans le répertoire `/functions` des pages cloudflare.

```typescript
// exporter le middleware compilé là où les Pages Cloudflare peuvent le trouver.
// par exemple utilisez /functions/[[path]].ts ou /functions/_middleware.ts
// pour que Qwik City gère toutes les requêtes.

export { onRequest } from '../server/entry.cloudflare-pages';
```

- [Source du Middleware de Cloudflare Pages](https://github.com/BuilderIO/qwik/tree/main/packages/qwik-city/middleware/cloudflare-pages/index.ts)
- [Fonctions de Cloudflare Pages](https://developers.cloudflare.com/pages/platform/functions/)

## Utilisation

### Contexte

Vous pouvez accéder aux variables d'environnement de la page Cloudflare dans le paramètre `platform` de la méthode du endpoint :

```javascript
export const onRequest = async ({ platform }) => {
  const secret = platform.env["SUPER_SECRET_TOKEN"];
};
```

De plus, vous pouvez importer le type `RequestHandlerCloudflarePages` pour avoir des compléments de type dans votre éditeur.

```typescript
import {type RequestHandlerCloudflarePages} from '@builder.io/qwik-city/middleware/cloudflare-pages';

export const onGet: RequestHandlerCloudflarePages = (({ platform }) => {
 //...
})
```
